var len,Setaduio,percent,$=window.Zepto,index=0,root=window.player;function init(){getDate()}function getDate(){$.ajax({type:"GET",url:"../mock/data.json",success:function(t){root.drawing(index,t),root.setList(t),root.setTime(t[index].duration),len=t.length-1,Setaduio=new root.Setaduio(index,t),replace(len,t),aduioClik(),startList(t),touch(t)},error:function(){void 0}})}function replace(t,o){$(".pre").on("click",function(){0==index?index=t:index--,root.setTime(o[index].duration),root.drawing(index,o),Setaduio.load(index,o),root.update(0),root.startTime(0),"pause"==Setaduio.tag?(Setaduio.play(),root.startTime(0)):Setaduio.pause()}),$(".next").on("click",function(){index==t?index=0:index++,root.setTime(o[index].duration),root.drawing(index,o),Setaduio.load(index,o),root.startTime(0),root.update(0),"pause"==Setaduio.tag?(Setaduio.play(),root.startTime(0)):(Setaduio.pause(),root.stopTime())})}function aduioClik(){$(".play").on("click",function(){"play"==Setaduio.tag?($(".play ").addClass("playing"),Setaduio.play(),root.startTime()):(Setaduio.pause(),$(".play").removeClass("playing"),root.stopTime())})}function startList(o){$(".song").on("click",function(){$(".song-list-wapper").css({display:"block"})}),$(".shut").on("click",function(){$(".song-list-wapper").css({display:"none"}),Setaduio.pause(),root.stopTime()}),$(".song-list-wapper .songlist").on("click",function(){var t=$(this).index()-1;index=t,root.drawing(t,o),Setaduio.load(t,o),Setaduio.play(),root.startTime(0)})}function touch(e){var t=$(".art.top").offset(),i=t.width,n=t.left+i;$(".org").on("touchstart",function(t){root.stopTime(),Setaduio.pause()}).on("touchmove",function(t){var o=t.changedTouches[0].clientX;((percent=(o-n)/i)<0||1<percent)&&(percent=0),root.update(percent)}).on("touchend",function(t){var o=e[index].duration*percent;"play"==Setaduio.tag?(Setaduio.cont(o),$(".play ").addClass("playing"),Setaduio.play(),root.startTime(percent)):(Setaduio.pause(),$(".play").removeClass("playing"),root.stopTime())})}init();